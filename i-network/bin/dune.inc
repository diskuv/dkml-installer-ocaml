; Auto-generated by package-dune-of-installer-generator.exe.
; Do not edit unless need to regenerate!
; When regenerating, erase **all** content from this file, save the file, and then run:
;   dune clean
;   dune build '@i-network/bin/gen-dkml' --auto-promote
(executable (public_name dkml-installer-ocaml-network-user-runner)
 (package dkml-installer-ocaml-network) (name runner_user)
 (modules runner_user) (ocamlopt_flags (:include ./user-link-flags.sexp))
 (libraries dkml-install-runner.user private_common
  dkml-component-ocamlcompiler-common dkml-component-ocamlcompiler-network
  dkml-component-offline-desktop-full dkml-component-offline-opamshim
  dkml-component-offline-unixutils dkml-component-staging-desktop-full
  dkml-component-staging-dkmlconfdir dkml-component-staging-ocamlrun
  dkml-component-staging-opam32 dkml-component-staging-opam64
  dkml-component-staging-unixutils dkml-component-staging-withdkml))

(executable (public_name dkml-installer-ocaml-network-admin-runner)
 (package dkml-installer-ocaml-network) (name runner_admin)
 (modules runner_admin) (ocamlopt_flags (:include ./admin-link-flags.sexp))
 (libraries dkml-install-runner.admin private_common
  dkml-component-ocamlcompiler-common dkml-component-ocamlcompiler-network
  dkml-component-offline-desktop-full dkml-component-offline-opamshim
  dkml-component-offline-unixutils dkml-component-staging-desktop-full
  dkml-component-staging-dkmlconfdir dkml-component-staging-ocamlrun
  dkml-component-staging-opam32 dkml-component-staging-opam64
  dkml-component-staging-unixutils dkml-component-staging-withdkml))

(executable (public_name dkml-installer-ocaml-network-create-installers)
 (package dkml-installer-ocaml-network) (name create_installers)
 (libraries dkml-package-console.create cmdliner private_common
  dkml-component-ocamlcompiler-common dkml-component-ocamlcompiler-network
  dkml-component-offline-desktop-full dkml-component-offline-opamshim
  dkml-component-offline-unixutils dkml-component-staging-desktop-full
  dkml-component-staging-dkmlconfdir dkml-component-staging-ocamlrun
  dkml-component-staging-opam32 dkml-component-staging-opam64
  dkml-component-staging-unixutils dkml-component-staging-withdkml)
 (modules create_installers))

(executable (public_name dkml-installer-ocaml-network-package-install)
 (package dkml-installer-ocaml-network) (name entry_install)
 (libraries dkml-package-console.entry cmdliner private_common
  dkml-component-ocamlcompiler-common dkml-component-ocamlcompiler-network
  dkml-component-offline-desktop-full dkml-component-offline-opamshim
  dkml-component-offline-unixutils dkml-component-staging-desktop-full
  dkml-component-staging-dkmlconfdir dkml-component-staging-ocamlrun
  dkml-component-staging-opam32 dkml-component-staging-opam64
  dkml-component-staging-unixutils dkml-component-staging-withdkml)
 (modules entry_install)
 (ocamlopt_flags (:include ./console-link-flags.sexp)))

(executable (public_name dkml-installer-ocaml-network-package-uninstall)
 (package dkml-installer-ocaml-network) (name entry_uninstall)
 (libraries dkml-package-console.entry cmdliner private_common
  dkml-component-ocamlcompiler-common dkml-component-ocamlcompiler-network
  dkml-component-offline-desktop-full dkml-component-offline-opamshim
  dkml-component-staging-ocamlrun)
 (modules entry_uninstall)
 (ocamlopt_flags (:include ./console-link-flags.sexp)))

(executable (public_name dkml-installer-ocaml-network-package-setup)
 (package dkml-installer-ocaml-network) (name package_setup)
 (modes (byte exe))
 (libraries dkml-package-console.setup cmdliner private_common
  dkml-component-ocamlcompiler-common dkml-component-ocamlcompiler-network
  dkml-component-offline-desktop-full dkml-component-offline-opamshim
  dkml-component-offline-unixutils dkml-component-staging-desktop-full
  dkml-component-staging-dkmlconfdir dkml-component-staging-ocamlrun
  dkml-component-staging-opam32 dkml-component-staging-opam64
  dkml-component-staging-unixutils dkml-component-staging-withdkml)
 (modules package_setup))

(executable (public_name dkml-installer-ocaml-network-package-uninstaller)
 (package dkml-installer-ocaml-network) (name package_uninstaller)
 (modes (byte exe))
 (libraries dkml-package-console.uninstaller cmdliner private_common
  dkml-component-ocamlcompiler-common dkml-component-ocamlcompiler-network
  dkml-component-offline-desktop-full dkml-component-offline-opamshim
  dkml-component-staging-ocamlrun)
 (modules package_uninstaller))

(install (section bin) (package dkml-installer-ocaml-network)
 (files (package_setup.bc as dkml-installer-ocaml-network-package-setup.bc)
  (package_uninstaller.bc as
   dkml-installer-ocaml-network-package-uninstaller.bc)))

(rule (alias runtest) (package dkml-installer-ocaml-network)
 (deps (:ps package_setup.bc) (:pu package_uninstaller.bc))
 (action
  (progn (with-stdout-to package_setup.info.txt (run ocamlobjinfo %{ps}))
   (with-stdout-to package_uninstaller.info.txt (run ocamlobjinfo %{pu}))
   (with-stdout-to dlls.corrected.txt
    (progn
     (run awk
      "/.*:/ {x=0} /Used DLLs:/{x=1; $1=\"package_setup.bc Used\"} x==1 {print}"
      package_setup.info.txt)
     (run awk
      "/.*:/ {x=0} /Used DLLs:/{x=1; $1=\"package_uninstaller.bc Used\"} x==1 {print}"
      package_uninstaller.info.txt)))
   (diff? dlls.txt dlls.corrected.txt))))
